<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Prometheus  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset="utf-8">
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
    <script src="js/lunr.min.js" defer></script>
    <script src="js/typeahead.jquery.js" defer></script>
    <script src="js/jazzy.search.js" defer></script>
  </head>
  <body>


    <a title="Prometheus  Reference"></a>

    <header class="header">
      <p class="header-col header-col--primary">
        <a class="header-link" href="index.html">
          Prometheus Docs
        </a>
         (97% documented)
      </p>
    
      <p class="header-col--secondary">
        <form role="search" action="search.json">
          <input type="text" placeholder="Search documentation" data-typeahead>
        </form>
      </p>
    
        <p class="header-col header-col--secondary">
          <a class="header-link" href="https://github.com/MrLotU/SwiftPrometheus">
            <img class="header-icon" src="img/gh.png"/>
            View on GitHub
          </a>
        </p>
    
        <p class="header-col header-col--secondary">
          <a class="header-link" href="dash-feed://https%3A%2F%2Fmrlotu%2Egithub%2Eio%2FSwiftPrometheus%2Fdocsets%2FPrometheus%2Exml">
            <img class="header-icon" src="img/dash.png"/>
            Install in Dash
          </a>
        </p>
    </header>

    <p class="breadcrumbs">
      <a class="breadcrumb" href="index.html">Prometheus Reference</a>
      <img class="carat" src="img/carat.png" />
      Prometheus  Reference
    </p>

    <div class="content-wrapper">
      <nav class="navigation">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Classes.html">Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/PromCounter.html">PromCounter</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/PromGauge.html">PromGauge</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/PromHistogram.html">PromHistogram</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/PromSummary.html">PromSummary</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/PrometheusClient.html">PrometheusClient</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Global Variables.html">Global Variables</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Global Variables.html#/s:10Prometheus14defaultBucketsSaySdGvp">defaultBuckets</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Global Variables.html#/s:10Prometheus16defaultQuantilesSaySdGvp">defaultQuantiles</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Enums.html">Enumerations</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MetricType.html">MetricType</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/PrometheusError.html">PrometheusError</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Extensions.html">Extensions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/CGFloat.html">CGFloat</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/Double.html">Double</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/FixedWidthInteger.html">FixedWidthInteger</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/Float.html">Float</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Protocols.html">Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/ConvertibleNumberType.html">ConvertibleNumberType</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/DoubleRepresentable.html">DoubleRepresentable</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/HistogramLabels.html">HistogramLabels</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/Metric.html">Metric</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/MetricLabels.html">MetricLabels</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/SummaryLabels.html">SummaryLabels</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Structs.html">Structures</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/EmptyHistogramLabels.html">EmptyHistogramLabels</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/EmptyLabels.html">EmptyLabels</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/EmptySummaryLabels.html">EmptySummaryLabels</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">

        <section class="section">
          <div class="section-content">
            
            <p><a href="https://circleci.com/gh/MrLotU/SwiftPrometheus"><img src="https://circleci.com/gh/MrLotU/SwiftPrometheus.svg?style=svg" alt="CircleCI"></a><a href="http://swift.org"><img src="https://img.shields.io/badge/swift-5.0-orange.svg?style=flat" alt="Swift 5.0"></a></p>
<h1 id='swiftprometheus-prometheus-client-for-swift' class='heading'>SwiftPrometheus, Prometheus client for Swift</h1>

<p>A prometheus client for Swift supporting counters, gauges, histograms, summaries and info.</p>
<h1 id='usage' class='heading'>Usage</h1>

<p>For examples, see <a href="./Sources/PrometheusExample/main.swift">main.swift</a></p>

<p>First, we have to create an instance of our <code><a href="Classes/PrometheusClient.html">PrometheusClient</a></code>:</p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">Prometheus</span>
<span class="k">let</span> <span class="nv">myProm</span> <span class="o">=</span> <span class="kt">PrometheusClient</span><span class="p">()</span>
</code></pre>
<h2 id='usage-with-swift-metrics' class='heading'>Usage with Swift-Metrics</h2>

<p><em>For more details about swift-metrics, check the GitHub repo <a href="https://github.com/apple/swift-metrics">here</a></em></p>

<p>To use SwiftPrometheus with swift-metrics, all the setup required is this:</p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">PrometheusMetrics</span> <span class="c1">// Auto imports Prometheus too, but adds the swift-metrics compatibility</span>
<span class="k">let</span> <span class="nv">myProm</span> <span class="o">=</span> <span class="kt">PrometheusClient</span><span class="p">()</span>
<span class="kt">MetricsSystem</span><span class="o">.</span><span class="nf">bootstrap</span><span class="p">(</span><span class="n">myProm</span><span class="p">)</span>
</code></pre>

<p>To use prometheus specific features in a later stage of your program, or to get your metrics out of the system, there is a convenience method added to <code>MetricsSystem</code>:</p>
<pre class="highlight swift"><code><span class="c1">// This is the same instance was used in `.bootstrap()` earlier.</span>
<span class="k">let</span> <span class="nv">promInstance</span> <span class="o">=</span> <span class="k">try</span> <span class="kt">MetricsSystem</span><span class="o">.</span><span class="nf">prometheus</span><span class="p">()</span>
</code></pre>

<p>You can than use the same APIs that are layed out in the rest of this README</p>
<h2 id='counter' class='heading'>Counter</h2>

<p>Counters go up, and reset when the process restarts.</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">counter</span> <span class="o">=</span> <span class="n">myProm</span><span class="o">.</span><span class="nf">createCounter</span><span class="p">(</span><span class="nv">forType</span><span class="p">:</span> <span class="kt">Int</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">named</span><span class="p">:</span> <span class="s">"my_counter"</span><span class="p">)</span>
<span class="n">counter</span><span class="o">.</span><span class="nf">inc</span><span class="p">()</span> <span class="c1">// Increment by 1</span>
<span class="n">counter</span><span class="o">.</span><span class="nf">inc</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="c1">// Increment by given value </span>
</code></pre>
<h2 id='gauge' class='heading'>Gauge</h2>

<p>Gauges can go up and down</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">gauge</span> <span class="o">=</span> <span class="n">myProm</span><span class="o">.</span><span class="nf">createGauge</span><span class="p">(</span><span class="nv">forType</span><span class="p">:</span> <span class="kt">Int</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">named</span><span class="p">:</span> <span class="s">"my_gauge"</span><span class="p">)</span>
<span class="n">gauge</span><span class="o">.</span><span class="nf">inc</span><span class="p">()</span> <span class="c1">// Increment by 1</span>
<span class="n">gauge</span><span class="o">.</span><span class="nf">dec</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span> <span class="c1">// Decrement by given value</span>
<span class="n">gauge</span><span class="o">.</span><span class="nf">set</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="c1">// Set to a given value</span>
</code></pre>
<h2 id='histogram' class='heading'>Histogram</h2>

<p>Histograms track the size and number of events in buckets. This allows for aggregatable calculation of quantiles.</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">histogram</span> <span class="o">=</span> <span class="n">myProm</span><span class="o">.</span><span class="nf">createHistogram</span><span class="p">(</span><span class="nv">forType</span><span class="p">:</span> <span class="kt">Double</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">named</span><span class="p">:</span> <span class="s">"my_histogram"</span><span class="p">)</span>
<span class="n">histogram</span><span class="o">.</span><span class="nf">observe</span><span class="p">(</span><span class="mf">4.7</span><span class="p">)</span> <span class="c1">// Observe the given value</span>
</code></pre>
<h2 id='summary' class='heading'>Summary</h2>

<p>Summaries track the size and number of events</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">summary</span> <span class="o">=</span> <span class="n">myProm</span><span class="o">.</span><span class="nf">createSummary</span><span class="p">(</span><span class="nv">forType</span><span class="p">:</span> <span class="kt">Double</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">named</span><span class="p">:</span> <span class="s">"my_summary"</span><span class="p">)</span>
<span class="n">summary</span><span class="o">.</span><span class="nf">observe</span><span class="p">(</span><span class="mf">4.7</span><span class="p">)</span> <span class="c1">// Observe the given value</span>
</code></pre>
<h2 id='info' class='heading'>Info</h2>

<p>Info tracks key-value information, usually about a whole target.</p>
<pre class="highlight swift"><code><span class="kd">struct</span> <span class="kt">MyInfoStruct</span><span class="p">:</span> <span class="kt">MetricLabels</span> <span class="p">{</span>
   <span class="k">let</span> <span class="nv">value</span><span class="p">:</span> <span class="kt">String</span>

   <span class="nf">init</span><span class="p">()</span> <span class="p">{</span>
       <span class="k">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="s">"abc"</span>
   <span class="p">}</span>

   <span class="nf">init</span><span class="p">(</span><span class="n">_</span> <span class="nv">v</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span> <span class="p">{</span>
       <span class="k">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">v</span>
   <span class="p">}</span>
<span class="p">}</span>

<span class="k">let</span> <span class="nv">info</span> <span class="o">=</span> <span class="n">myProm</span><span class="o">.</span><span class="nf">createInfo</span><span class="p">(</span><span class="nv">named</span><span class="p">:</span> <span class="s">"my_info"</span><span class="p">,</span> <span class="nv">helpText</span><span class="p">:</span> <span class="s">"Just some info"</span><span class="p">,</span> <span class="nv">labelType</span><span class="p">:</span> <span class="kt">MyInfoStruct</span><span class="o">.</span><span class="k">self</span><span class="p">)</span>

<span class="k">let</span> <span class="nv">info</span> <span class="o">=</span> <span class="n">prom</span><span class="o">.</span><span class="nf">createInfo</span><span class="p">(</span><span class="nv">named</span><span class="p">:</span> <span class="s">"my_info"</span><span class="p">,</span> <span class="nv">helpText</span><span class="p">:</span> <span class="s">"Just some info"</span><span class="p">,</span> <span class="nv">labelType</span><span class="p">:</span> <span class="kt">MyInfoStruct</span><span class="o">.</span><span class="k">self</span><span class="p">)</span>

<span class="n">info</span><span class="o">.</span><span class="nf">info</span><span class="p">(</span><span class="kt">MyInfoStruct</span><span class="p">(</span><span class="s">"def"</span><span class="p">))</span>
</code></pre>
<h2 id='labels' class='heading'>Labels</h2>

<p>All metric types support adding labels, allowing for grouping of related metrics.</p>

<p>Example with a counter:</p>
<pre class="highlight swift"><code><span class="kd">struct</span> <span class="kt">RouteLabels</span><span class="p">:</span> <span class="kt">MetricLabels</span> <span class="p">{</span>
   <span class="k">var</span> <span class="nv">route</span><span class="p">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">"*"</span>
<span class="p">}</span>

<span class="k">let</span> <span class="nv">counter</span> <span class="o">=</span> <span class="n">myProm</span><span class="o">.</span><span class="nf">createCounter</span><span class="p">(</span><span class="nv">forType</span><span class="p">:</span> <span class="kt">Int</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">named</span><span class="p">:</span> <span class="s">"my_counter"</span><span class="p">,</span> <span class="nv">helpText</span><span class="p">:</span> <span class="s">"Just a counter"</span><span class="p">,</span> <span class="nv">withLabelType</span><span class="p">:</span> <span class="kt">RouteLabels</span><span class="o">.</span><span class="k">self</span><span class="p">)</span>

<span class="k">let</span> <span class="nv">counter</span> <span class="o">=</span> <span class="n">prom</span><span class="o">.</span><span class="nf">createCounter</span><span class="p">(</span><span class="nv">forType</span><span class="p">:</span> <span class="kt">Int</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">named</span><span class="p">:</span> <span class="s">"my_counter"</span><span class="p">,</span> <span class="nv">helpText</span><span class="p">:</span> <span class="s">"Just a counter"</span><span class="p">,</span> <span class="nv">withLabelType</span><span class="p">:</span> <span class="kt">RouteLabels</span><span class="o">.</span><span class="k">self</span><span class="p">)</span>

<span class="n">counter</span><span class="o">.</span><span class="nf">inc</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">route</span><span class="p">:</span> <span class="s">"/"</span><span class="p">))</span>
</code></pre>
<h1 id='exporting' class='heading'>Exporting</h1>

<p>To keep SwiftPrometheus as clean and lightweight as possible, there is no way of exporting metrics directly to Prometheus. Instead, retrieve a formatted string that Prometheus can use, so you can integrate it in your own Serverside Swift application</p>

<p>This could look something like this:</p>
<pre class="highlight swift"><code><span class="n">router</span><span class="o">.</span><span class="nf">get</span><span class="p">(</span><span class="s">"/metrics"</span><span class="p">)</span> <span class="p">{</span> <span class="n">request</span> <span class="o">-&gt;</span> <span class="kt">String</span> <span class="k">in</span>
    <span class="k">return</span> <span class="n">myProm</span><span class="o">.</span><span class="nf">getMetrics</span><span class="p">()</span>
<span class="p">}</span>
</code></pre>

<p>Here, I used <a href="https://github.com/vapor/vapor">Vapor</a> syntax, but this will work with any web framework, since it&rsquo;s just returning a plain String.</p>
<h1 id='contributing' class='heading'>Contributing</h1>

<p>All contributions are most welcome!</p>

<p>-If you think of some cool new feature that should be included, please <a href="https://github.com/MrLotU/SwiftPrometheus/issues/new/choose">create an issue</a>. Or, if you want to implement it yourself, <a href="https://github.com/MrLotU/SwiftPrometheus/fork">fork this repo</a> and submit a PR!</p>

<p>If you find a bug or have issues, please <a href="https://github.com/MrLotU/SwiftPrometheus/issues/new/choose">create an issue</a> explaining your problems. Please include as much information as possible, so it&rsquo;s easier for me to reproduce (Framework, OS, Swift version, terminal output, etc.)</p>

          </div>
        </section>


      </article>
    </div>
    <section class="footer">
      <p>&copy; 2019 <a class="link" href="https://github.com/MrLotU" target="_blank" rel="external">MrLotU</a>. All rights reserved. (Last updated: 2019-06-07)</p>
      <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.9.4</a>, a <a class="link" href="https://realm.io" target="_blank" rel="external">Realm</a> project.</p>
    </section>
  </body>
</div>
</html>
